import{g as P,d as U,u as $,f as C,s as z,i as D,m as V,h as H,o as ce,r as b,j as t,B as R,c as de,T as E,b as N,R as pe,A as q,P as ue,J as W,t as fe,I as X,K as Q,N as Y,O as G,Q as Z,U as he,V as ye,W as ge,X as xe,Y as me}from"./index-RnQI40tk.js";import{A as ve}from"./Add-DryMe5yZ.js";import{r as f}from"./redux-CHunf9nH.js";import{c as I}from"./charts-BQCo6uAH.js";import{T as _}from"./Tooltip-Dgbn0XIi.js";import{T as J}from"./TextField-DC-0rrgg.js";import{L as be}from"./ListItemIcon-BP1evcdG.js";import{D as Ce}from"./Divider-Cfis5FCm.js";import"./react-Dqn7FESC.js";import"./router-muBVCOlq.js";import"./useControlled-BELcKehV.js";import"./useSlotProps-CNI6Fs2q.js";import"./Select-iYrgATPy.js";import"./listItemIconClasses-DBQaSeYT.js";import"./dividerClasses-CCiAYvGY.js";const ne=f.createContext();function je(e){return P("MuiTable",e)}U("MuiTable",["root","stickyHeader"]);const Te=e=>{const{classes:s,stickyHeader:o}=e;return D({root:["root",o&&"stickyHeader"]},je,s)},we=z("table",{name:"MuiTable",slot:"Root",overridesResolver:(e,s)=>{const{ownerState:o}=e;return[s.root,o.stickyHeader&&s.stickyHeader]}})(V(({theme:e})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...e.typography.body2,padding:e.spacing(2),color:(e.vars||e).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:s})=>s.stickyHeader,style:{borderCollapse:"separate"}}]}))),ee="table",Se=f.forwardRef(function(s,o){const n=$({props:s,name:"MuiTable"}),{className:i,component:a=ee,padding:c="normal",size:l="medium",stickyHeader:p=!1,...y}=n,h={...n,component:a,padding:c,size:l,stickyHeader:p},j=Te(h),w=f.useMemo(()=>({padding:c,size:l,stickyHeader:p}),[c,l,p]);return C.jsx(ne.Provider,{value:w,children:C.jsx(we,{as:a,role:a===ee?null:"table",ref:o,className:I(j.root,i),ownerState:h,...y})})}),L=f.createContext();function Me(e){return P("MuiTableBody",e)}U("MuiTableBody",["root"]);const Re=e=>{const{classes:s}=e;return D({root:["root"]},Me,s)},ke=z("tbody",{name:"MuiTableBody",slot:"Root"})({display:"table-row-group"}),He={variant:"body"},te="tbody",Pe=f.forwardRef(function(s,o){const n=$({props:s,name:"MuiTableBody"}),{className:i,component:a=te,...c}=n,l={...n,component:a},p=Re(l);return C.jsx(L.Provider,{value:He,children:C.jsx(ke,{className:I(p.root,i),as:a,ref:o,role:a===te?null:"rowgroup",ownerState:l,...c})})});function Ue(e){return P("MuiTableCell",e)}const $e=U("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),ze=e=>{const{classes:s,variant:o,align:n,padding:i,size:a,stickyHeader:c}=e,l={root:["root",o,c&&"stickyHeader",n!=="inherit"&&`align${H(n)}`,i!=="normal"&&`padding${H(i)}`,`size${H(a)}`]};return D(l,Ue,s)},De=z("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,s)=>{const{ownerState:o}=e;return[s.root,s[o.variant],s[`size${H(o.size)}`],o.padding!=="normal"&&s[`padding${H(o.padding)}`],o.align!=="inherit"&&s[`align${H(o.align)}`],o.stickyHeader&&s.stickyHeader]}})(V(({theme:e})=>({...e.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:e.vars?`1px solid ${e.vars.palette.TableCell.border}`:`1px solid
    ${e.palette.mode==="light"?e.lighten(e.alpha(e.palette.divider,1),.88):e.darken(e.alpha(e.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(e.vars||e).palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(e.vars||e).palette.text.primary}},{props:{variant:"footer"},style:{color:(e.vars||e).palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${$e.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:({ownerState:s})=>s.stickyHeader,style:{position:"sticky",top:0,zIndex:2,backgroundColor:(e.vars||e).palette.background.default}}]}))),T=f.forwardRef(function(s,o){const n=$({props:s,name:"MuiTableCell"}),{align:i="inherit",className:a,component:c,padding:l,scope:p,size:y,sortDirection:h,variant:j,...w}=n,g=f.useContext(ne),x=f.useContext(L),m=x&&x.variant==="head";let u;c?u=c:u=m?"th":"td";let v=p;u==="td"?v=void 0:!v&&m&&(v="col");const S=j||x&&x.variant,A={...n,align:i,component:u,padding:l||(g&&g.padding?g.padding:"normal"),size:y||(g&&g.size?g.size:"medium"),sortDirection:h,stickyHeader:S==="head"&&g&&g.stickyHeader,variant:S},B=ze(A);let O=null;return h&&(O=h==="asc"?"ascending":"descending"),C.jsx(De,{as:u,ref:o,className:I(B.root,a),"aria-sort":O,scope:v,ownerState:A,...w})});function Ie(e){return P("MuiTableContainer",e)}U("MuiTableContainer",["root"]);const Ne=e=>{const{classes:s}=e;return D({root:["root"]},Ie,s)},Ae=z("div",{name:"MuiTableContainer",slot:"Root"})({width:"100%",overflowX:"auto"}),Oe=f.forwardRef(function(s,o){const n=$({props:s,name:"MuiTableContainer"}),{className:i,component:a="div",...c}=n,l={...n,component:a},p=Ne(l);return C.jsx(Ae,{ref:o,as:a,className:I(p.root,i),ownerState:l,...c})});function Ee(e){return P("MuiTableHead",e)}U("MuiTableHead",["root"]);const Le=e=>{const{classes:s}=e;return D({root:["root"]},Ee,s)},Be=z("thead",{name:"MuiTableHead",slot:"Root"})({display:"table-header-group"}),Fe={variant:"head"},se="thead",Ke=f.forwardRef(function(s,o){const n=$({props:s,name:"MuiTableHead"}),{className:i,component:a=se,...c}=n,l={...n,component:a},p=Le(l);return C.jsx(L.Provider,{value:Fe,children:C.jsx(Be,{as:a,className:I(p.root,i),ref:o,role:a===se?null:"rowgroup",ownerState:l,...c})})});function We(e){return P("MuiTableRow",e)}const oe=U("MuiTableRow",["root","selected","hover","head","footer"]),Je=e=>{const{classes:s,selected:o,hover:n,head:i,footer:a}=e;return D({root:["root",o&&"selected",n&&"hover",i&&"head",a&&"footer"]},We,s)},Ve=z("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(e,s)=>{const{ownerState:o}=e;return[s.root,o.head&&s.head,o.footer&&s.footer]}})(V(({theme:e})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${oe.hover}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${oe.selected}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`)}}}))),re="tr",ae=f.forwardRef(function(s,o){const n=$({props:s,name:"MuiTableRow"}),{className:i,component:a=re,hover:c=!1,selected:l=!1,...p}=n,y=f.useContext(L),h={...n,component:a,hover:c,selected:l,head:y&&y.variant==="head",footer:y&&y.variant==="footer"},j=Je(h);return C.jsx(Ve,{as:a,ref:o,className:I(j.root,i),role:a===re?null:"row",ownerState:h,...p})}),qe=ce(C.jsx("path",{d:"M17 7h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.43-.98 2.63-2.31 2.98l1.46 1.46C20.88 15.61 22 13.95 22 12c0-2.76-2.24-5-5-5m-1 4h-2.19l2 2H16zM2 4.27l3.11 3.11C3.29 8.12 2 9.91 2 12c0 2.76 2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1 0-1.59 1.21-2.9 2.76-3.07L8.73 11H8v2h2.73L13 15.27V17h1.73l4.01 4L20 19.74 3.27 3z"})),ct=()=>{const[e,s]=b.useState([]),[o,n]=b.useState(!0),[i,a]=b.useState(null),[c,l]=b.useState(!1),[p,y]=b.useState(null),[h,j]=b.useState(!1),[w,g]=b.useState([]),[x,m]=b.useState({open:!1,message:"",severity:"success"}),[u,v]=b.useState({name:"",serverUrl:"",apiKey:""}),S=async()=>{try{n(!0),a(null);const r=await fetch("/api/admin/mcp-servers");if(!r.ok)throw new Error("Failed to fetch MCP servers");const d=await r.json(),k=[];d.servers&&Object.entries(d.servers).forEach(([F,M])=>{const K=M;k.push({name:F,serverUrl:K.serverUrl||"",apiKey:K.apiKey||"",connected:!0})}),d.configurations&&d.configurations.forEach(F=>{const M=F;!k.find(ie=>ie.name===M.name)&&M.name&&k.push({name:M.name,serverUrl:M.serverUrl||"",apiKey:M.apiKey||"",connected:!1})}),s(k)}catch(r){a(r instanceof Error?r.message:"Failed to fetch MCP servers")}finally{n(!1)}};b.useEffect(()=>{S()},[]);const A=async()=>{try{if(!(await fetch("/api/admin/mcp-servers/connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)})).ok)throw new Error("Failed to connect to MCP server");m({open:!0,message:"MCP server connected successfully",severity:"success"}),l(!1),v({name:"",serverUrl:"",apiKey:""}),S()}catch(r){m({open:!0,message:r instanceof Error?r.message:"Failed to connect to MCP server",severity:"error"})}},B=async r=>{if(confirm(`Are you sure you want to disconnect from MCP server "${r}"?`))try{if(!(await fetch("/api/admin/mcp-servers/disconnect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r})})).ok)throw new Error("Failed to disconnect from MCP server");m({open:!0,message:"MCP server disconnected successfully",severity:"success"}),S()}catch(d){m({open:!0,message:d instanceof Error?d.message:"Failed to disconnect from MCP server",severity:"error"})}},O=async r=>{y(r);try{const d=await fetch(`/api/admin/mcp-servers/${r.name}/tools`);if(!d.ok)throw new Error("Failed to fetch tools");const k=await d.json();g(k.tools||[]),j(!0)}catch(d){m({open:!0,message:d instanceof Error?d.message:"Failed to fetch tools",severity:"error"})}},le=()=>{v({name:"",serverUrl:"",apiKey:""}),l(!0)};return o?t.jsx(R,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:t.jsx(de,{})}):t.jsxs(R,{children:[t.jsxs(R,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[t.jsx(E,{variant:"h5",component:"h2",children:"MCP Server Management"}),t.jsxs(R,{display:"flex",gap:1,children:[t.jsx(N,{variant:"outlined",startIcon:t.jsx(pe,{}),onClick:S,children:"Refresh"}),t.jsx(N,{variant:"contained",startIcon:t.jsx(ve,{}),onClick:le,children:"Connect Server"})]})]}),i&&t.jsx(q,{severity:"error",sx:{mb:2},children:i}),t.jsx(Oe,{component:ue,children:t.jsxs(Se,{children:[t.jsx(Ke,{children:t.jsxs(ae,{children:[t.jsx(T,{children:"Name"}),t.jsx(T,{children:"Server URL"}),t.jsx(T,{children:"Status"}),t.jsx(T,{children:"Actions"})]})}),t.jsx(Pe,{children:e.map(r=>t.jsxs(ae,{hover:!0,children:[t.jsx(T,{children:t.jsxs(R,{display:"flex",alignItems:"center",gap:1,children:[t.jsx(W,{color:"action"}),t.jsx(E,{variant:"body1",fontWeight:"medium",children:r.name})]})}),t.jsx(T,{children:t.jsx(E,{variant:"body2",fontFamily:"monospace",children:r.serverUrl})}),t.jsx(T,{children:t.jsx(fe,{label:r.connected?"Connected":"Disconnected",color:r.connected?"success":"default",size:"small"})}),t.jsx(T,{children:t.jsxs(R,{display:"flex",gap:1,children:[r.connected&&t.jsx(_,{title:"View Tools",children:t.jsx(X,{size:"small",onClick:()=>O(r),children:t.jsx(W,{})})}),t.jsx(_,{title:"Disconnect",children:t.jsx(X,{size:"small",onClick:()=>B(r.name),color:"error",children:t.jsx(qe,{})})})]})})]},r.name))})]})}),t.jsxs(Q,{open:c,onClose:()=>l(!1),maxWidth:"sm",fullWidth:!0,children:[t.jsx(Y,{children:"Connect to MCP Server"}),t.jsx(G,{children:t.jsxs(R,{sx:{mt:1},children:[t.jsx(J,{fullWidth:!0,label:"Server Name",value:u.name,onChange:r=>v({...u,name:r.target.value}),required:!0,sx:{mb:2}}),t.jsx(J,{fullWidth:!0,label:"Server URL",value:u.serverUrl,onChange:r=>v({...u,serverUrl:r.target.value}),required:!0,helperText:"The URL of the MCP server",sx:{mb:2}}),t.jsx(J,{fullWidth:!0,label:"API Key (Optional)",value:u.apiKey,onChange:r=>v({...u,apiKey:r.target.value}),type:"password",helperText:"API key for server authentication (if required)"})]})}),t.jsxs(Z,{children:[t.jsx(N,{onClick:()=>l(!1),children:"Cancel"}),t.jsx(N,{onClick:A,variant:"contained",children:"Connect Server"})]})]}),t.jsxs(Q,{open:h,onClose:()=>j(!1),maxWidth:"md",fullWidth:!0,children:[t.jsxs(Y,{children:["Tools - ",p?.name]}),t.jsx(G,{children:w.length>0?t.jsx(he,{children:w.map((r,d)=>t.jsxs(ye.Fragment,{children:[t.jsxs(ge,{children:[t.jsx(be,{children:t.jsx(W,{})}),t.jsx(xe,{primary:r.name,secondary:r.description})]}),d<w.length-1&&t.jsx(Ce,{})]},r.name))}):t.jsx(E,{variant:"body2",color:"text.secondary",children:"No tools available for this server."})}),t.jsx(Z,{children:t.jsx(N,{onClick:()=>j(!1),children:"Close"})})]}),t.jsx(me,{open:x.open,autoHideDuration:6e3,onClose:()=>m({...x,open:!1}),children:t.jsx(q,{onClose:()=>m({...x,open:!1}),severity:x.severity,sx:{width:"100%"},children:x.message})})]})};export{ct as default};
