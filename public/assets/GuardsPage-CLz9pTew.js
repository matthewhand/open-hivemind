import{j as e,r as c,B as d,T as m,P as N,b as f,t as w,Y as S,A}from"./index-RnQI40tk.js";import{D,C as T}from"./redux-CHunf9nH.js";import{T as b}from"./TextField-DC-0rrgg.js";import{A as v}from"./Add-DryMe5yZ.js";import{S as C}from"./Stack-SvpvuKJv.js";import{D as P}from"./Delete-BgqdZpMV.js";import"./react-Dqn7FESC.js";import"./charts-BQCo6uAH.js";import"./router-muBVCOlq.js";import"./Select-iYrgATPy.js";import"./useSlotProps-CNI6Fs2q.js";import"./useControlled-BELcKehV.js";const y=({label:n,radioSize:a,color:r,className:o,disabled:u,...t})=>{const p={xs:"radio-xs",sm:"radio-sm",md:"radio-md",lg:"radio-lg"},l={primary:"radio-primary",secondary:"radio-secondary",accent:"radio-accent"},i=["radio",a?p[a]:"",r?l[r]:"",o].filter(Boolean).join(" ");return e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer",children:[n&&e.jsx("span",{className:"label-text",children:n}),e.jsx("input",{type:"radio",className:i,disabled:u,...t})]})})},L=()=>{D();const n=T(s=>s.config.guards),[a,r]=c.useState({type:"disabled",allowedUsers:[],allowedIPs:[]}),[o,u]=c.useState(""),[t,p]=c.useState(""),[l,i]=c.useState({open:!1,message:"",severity:"success"});c.useEffect(()=>{n&&r(n)},[n]);const x=s=>{r({...a,type:s.target.value})},g=()=>{o.trim()&&!a.allowedUsers.includes(o.trim())&&(r({...a,allowedUsers:[...a.allowedUsers,o.trim()]}),u(""))},I=s=>{r({...a,allowedUsers:a.allowedUsers.filter(h=>h!==s)})},j=()=>{t.trim()&&!a.allowedIPs.includes(t.trim())&&(r({...a,allowedIPs:[...a.allowedIPs,t.trim()]}),p(""))},U=s=>{r({...a,allowedIPs:a.allowedIPs.filter(h=>h!==s)})},k=async()=>{try{if(!(await fetch("/api/uber/guards",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw new Error("Failed to save guards configuration");i({open:!0,message:"Guards configuration saved successfully",severity:"success"})}catch(s){i({open:!0,message:s instanceof Error?s.message:"Failed to save guards configuration",severity:"error"})}};return e.jsxs(d,{children:[e.jsx(m,{variant:"h4",component:"h1",gutterBottom:!0,children:"MCP Tool Guards"}),e.jsx(m,{variant:"body1",color:"text.secondary",sx:{mb:3},children:"Configure access controls for MCP tools. Guards determine who can execute MCP tool operations."}),e.jsxs(N,{sx:{p:3},children:[e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Guard Type"})}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsx(y,{name:"guard-type",value:"disabled",checked:a.type==="disabled",onChange:x,label:"Disabled - No restrictions (anyone can use MCP tools)"}),e.jsx(y,{name:"guard-type",value:"owner",checked:a.type==="owner",onChange:x,label:"Owner Only - Only the server/forum owner can use MCP tools"}),e.jsx(y,{name:"guard-type",value:"users",checked:a.type==="users",onChange:x,label:"Specific Users - Only listed users can use MCP tools"})]})]}),a.type==="users"&&e.jsxs(d,{sx:{mb:3},children:[e.jsx(m,{variant:"h6",gutterBottom:!0,children:"Allowed Users"}),e.jsxs(d,{sx:{display:"flex",gap:1,mb:2},children:[e.jsx(b,{fullWidth:!0,label:"User ID or Username",value:o,onChange:s=>u(s.target.value),onKeyPress:s=>s.key==="Enter"&&g()}),e.jsx(f,{variant:"contained",startIcon:e.jsx(v,{}),onClick:g,disabled:!o.trim(),children:"Add"})]}),e.jsx(C,{direction:"row",spacing:1,flexWrap:"wrap",children:a.allowedUsers.map(s=>e.jsx(w,{label:s,onDelete:()=>I(s),deleteIcon:e.jsx(P,{})},s))})]}),e.jsxs(d,{sx:{mb:3},children:[e.jsx(m,{variant:"h6",gutterBottom:!0,children:"Allowed IP Addresses (Optional)"}),e.jsx(m,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Restrict access to specific IP addresses. Leave empty to allow all IPs."}),e.jsxs(d,{sx:{display:"flex",gap:1,mb:2},children:[e.jsx(b,{fullWidth:!0,label:"IP Address (e.g., 192.168.1.1)",value:t,onChange:s=>p(s.target.value),onKeyPress:s=>s.key==="Enter"&&j()}),e.jsx(f,{variant:"contained",startIcon:e.jsx(v,{}),onClick:j,disabled:!t.trim(),children:"Add"})]}),e.jsx(C,{direction:"row",spacing:1,flexWrap:"wrap",children:a.allowedIPs.map(s=>e.jsx(w,{label:s,onDelete:()=>U(s),deleteIcon:e.jsx(P,{}),variant:"outlined"},s))})]}),e.jsx(d,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(f,{variant:"contained",onClick:k,size:"large",children:"Save Configuration"})})]}),e.jsx(S,{open:l.open,autoHideDuration:6e3,onClose:()=>i({...l,open:!1}),children:e.jsx(A,{onClose:()=>i({...l,open:!1}),severity:l.severity,sx:{width:"100%"},children:l.message})})]})};export{L as default};
