import{an as M,r as l,j as e,p as R}from"./index-RnQI40tk.js";import{S as B}from"./StatusCard-CPnoqqGm.js";import{M as N}from"./MetricChart-DObaqncI.js";import{A as F}from"./AlertPanel-Dt4J9UkV.js";import"./react-Dqn7FESC.js";import"./redux-CHunf9nH.js";import"./charts-BQCo6uAH.js";import"./router-muBVCOlq.js";const V=({maxEvents:v=100,showFilters:C=!0,autoScroll:j=!0,refreshInterval:$,className:k="",onEventClick:E})=>{const{messageFlow:y,alerts:o,performanceMetrics:w,botStats:m}=M(),[h,x]=l.useState([]),[u,n]=l.useState("all"),[S,i]=l.useState("all"),[g,p]=l.useState(""),[t,c]=l.useState(!1),f=l.useRef(null),I=l.useRef(null);l.useEffect(()=>{if(t)return;const s=[];y.forEach((a,r)=>{s.push({id:`msg-${r}`,type:"message",title:`Message from ${a.source||"Unknown"}`,message:a.content||"New message received",timestamp:a.timestamp||new Date().toISOString(),source:a.source||"System",metadata:a,level:"low"})}),o.forEach((a,r)=>{s.push({id:`alert-${r}`,type:a.severity||"info",title:a.title||"System Alert",message:a.message||"",timestamp:a.timestamp||new Date().toISOString(),source:a.source||"System",metadata:a,level:a.severity==="error"?"critical":a.severity==="warning"?"high":"medium"})}),w.forEach((a,r)=>{s.push({id:`perf-${r}`,type:"performance",title:"Performance Update",message:`CPU: ${a.cpu?.toFixed(1)||0}%, Memory: ${a.memory?.toFixed(1)||0}%`,timestamp:a.timestamp||new Date().toISOString(),source:"Performance Monitor",metadata:a,level:"low"})}),m.forEach((a,r)=>{s.push({id:`bot-${r}`,type:"bot_status",title:`Bot Activity: ${a.name}`,message:`Messages: ${a.messageCount}, Errors: ${a.errorCount}`,timestamp:new Date().toISOString(),source:"Bot Monitor",metadata:a,level:a.errorCount>0?"medium":"low"})});const d=[...s,...h].sort((a,r)=>new Date(r.timestamp).getTime()-new Date(a.timestamp).getTime()).slice(0,v);x(d)},[y,o,w,m,t,v]),l.useEffect(()=>{j&&!t&&f.current&&f.current.scrollIntoView({behavior:"smooth"})},[h,j,t]);const b=h.filter(s=>{const d=u==="all"||s.type===u,a=S==="all"||s.level===S,r=!g||s.title.toLowerCase().includes(g.toLowerCase())||s.message.toLowerCase().includes(g.toLowerCase())||s.source.toLowerCase().includes(g.toLowerCase());return d&&a&&r}),D=s=>{switch(s){case"message":return"💬";case"error":return"❌";case"warning":return"⚠️";case"info":return"ℹ️";case"system":return"⚙️";case"bot_status":return"🤖";case"performance":return"📊";default:return"📝"}},L=s=>{switch(s){case"error":return"text-error";case"warning":return"text-warning";case"info":return"text-info";case"performance":return"text-success";case"bot_status":return"text-primary";default:return"text-neutral"}},T=s=>({low:"badge-success",medium:"badge-warning",high:"badge-warning",critical:"badge-error"})[s]||"badge-neutral",A=s=>{const d=new Date(s),r=new Date().getTime()-d.getTime();return r<5e3?"Just now":r<6e4?`${Math.floor(r/1e3)}s ago`:r<36e5?`${Math.floor(r/6e4)}m ago`:r<864e5?`${Math.floor(r/36e5)}h ago`:d.toLocaleDateString()},P=s=>{E?.(s)},U=()=>{x([])},O=()=>{const s=JSON.stringify(b,null,2),d="data:application/json;charset=utf-8,"+encodeURIComponent(s),a=`events-${new Date().toISOString().split("T")[0]}.json`,r=document.createElement("a");r.setAttribute("href",d),r.setAttribute("download",a),r.click()};return e.jsx("div",{className:`card bg-base-100 shadow-xl ${k}`,children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"card-title",children:"Event Stream"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:`btn btn-sm ${t?"btn-warning":"btn-ghost"}`,onClick:()=>c(!t),children:t?"▶️ Resume":"⏸️ Pause"}),e.jsx("button",{className:"btn btn-sm btn-ghost",onClick:U,children:"🗑️ Clear"}),e.jsx("button",{className:"btn btn-sm btn-ghost",onClick:O,children:"📥 Export"})]})]}),C&&e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-4",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{className:`btn btn-xs ${u==="all"?"btn-primary":"btn-ghost"}`,onClick:()=>n("all"),children:"All"}),e.jsx("button",{className:`btn btn-xs ${u==="message"?"btn-primary":"btn-ghost"}`,onClick:()=>n("message"),children:"Messages"}),e.jsx("button",{className:`btn btn-xs ${u==="system"?"btn-primary":"btn-ghost"}`,onClick:()=>n("system"),children:"System"}),e.jsx("button",{className:`btn btn-xs ${u==="bot_status"?"btn-primary":"btn-ghost"}`,onClick:()=>n("bot_status"),children:"Bots"}),e.jsx("button",{className:`btn btn-xs ${u==="performance"?"btn-primary":"btn-ghost"}`,onClick:()=>n("performance"),children:"Performance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{className:"select select-xs select-bordered",value:S,onChange:s=>i(s.target.value),children:[e.jsx("option",{value:"all",children:"All Levels"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]}),e.jsx("input",{type:"text",placeholder:"Search events...",className:"input input-xs input-bordered",value:g,onChange:s=>p(s.target.value)})]})]}),e.jsxs("div",{ref:I,className:"space-y-2 max-h-96 overflow-y-auto bg-base-200 rounded-lg p-4",children:[b.length===0?e.jsxs("div",{className:"text-center py-8 text-neutral-content/50",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📡"}),e.jsx("p",{children:"No events to display"}),t&&e.jsx("p",{className:"text-sm mt-2",children:"Stream is paused"})]}):b.map(s=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-base-100 hover:bg-base-300 cursor-pointer transition-colors",onClick:()=>P(s),children:[e.jsx("div",{className:"text-2xl flex-shrink-0",children:D(s.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:`font-semibold text-sm ${L(s.type)}`,children:s.title}),e.jsx("span",{className:`badge badge-xs ${T(s.level)}`,children:s.level})]}),e.jsx("p",{className:"text-xs text-neutral-content/80 mb-1",children:s.message}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-neutral-content/60",children:[e.jsx("span",{children:s.source}),e.jsx("span",{children:"•"}),e.jsx("span",{children:A(s.timestamp)})]})]})]},s.id)),e.jsx("div",{ref:f})]}),h.length>0&&e.jsxs("div",{className:"mt-4 flex justify-between items-center text-xs text-neutral-content/60",children:[e.jsxs("span",{children:["Showing ",b.length," of ",h.length," events"]}),t&&e.jsx("span",{className:"text-warning",children:"Stream paused"})]})]})})},G=()=>{const{isConnected:v,connect:C,disconnect:j,performanceMetrics:$,alerts:k}=M(),[E,y]=l.useState(null),[o,w]=l.useState(null),[m,h]=l.useState(!0),[x,u]=l.useState(5e3);l.useEffect(()=>{C(),n();const t=setInterval(()=>{n()},x);return()=>{clearInterval(t),j()}},[x]);const n=async()=>{try{const[t,c]=await Promise.all([R.getStatus(),R.getSystemHealth()]);w(t),y(c),h(!1)}catch(t){console.error("Failed to fetch system data:",t),h(!1)}},i=E||{cpu:{total:40},memory:{usage:39},disk:{usage:25},network:{rx:1024,tx:2048}},g=[{title:"System Health",subtitle:"Overall system status",status:o?.bots?.some(t=>t.status==="error")?"error":o?.bots?.some(t=>t.status==="warning")?"warning":"healthy",metrics:[{label:"CPU Usage",value:i.cpu?.total||0,unit:"%",trend:"stable"},{label:"Memory",value:i.memory?.usage||0,unit:"%",trend:"up",trendValue:5},{label:"Disk",value:i.disk?.usage||0,unit:"%",trend:"stable"},{label:"Uptime",value:o?.uptime||0,unit:"s",icon:"⏱️"}],refreshInterval:5e3,onRefresh:n,isLoading:m},{title:"Bot Status",subtitle:"Connected bots and activity",status:o?.bots?.some(t=>t.status==="error")?"error":"healthy",metrics:[{label:"Total Bots",value:o?.bots?.length||0,icon:"🤖"},{label:"Active",value:o?.bots?.filter(t=>t.status==="online")?.length||0,icon:"✅"},{label:"Errors",value:o?.bots?.filter(t=>t.status==="error")?.length||0,icon:"❌"},{label:"Messages",value:o?.bots?.reduce((t,c)=>t+(c.messageCount||0),0)||0,icon:"💬"}],refreshInterval:1e4,onRefresh:n,isLoading:m},{title:"Performance",subtitle:"System performance metrics",status:i.cpu?.total>80?"error":i.cpu?.total>60?"warning":"healthy",metrics:[{label:"Response Time",value:125,unit:"ms",trend:"down",trendValue:-8},{label:"Throughput",value:1024,unit:"req/s",trend:"up",trendValue:12},{label:"Error Rate",value:.5,unit:"%",trend:"stable"},{label:"Queue Size",value:42,unit:"items",trend:"down",trendValue:-15}],refreshInterval:5e3,onRefresh:n,isLoading:m},{title:"Network",subtitle:"Network traffic and status",status:"healthy",metrics:[{label:"Incoming",value:(i.network?.rx||0)/1024,unit:"KB/s",trend:"up",trendValue:23},{label:"Outgoing",value:(i.network?.tx||0)/1024,unit:"KB/s",trend:"stable"},{label:"Connections",value:156,icon:"🔗"},{label:"Latency",value:12,unit:"ms",trend:"down",trendValue:-5}],refreshInterval:3e3,onRefresh:n,isLoading:m}],p=(t,c=10)=>{const f=new Date;return Array.from({length:20},(I,b)=>({timestamp:new Date(f.getTime()-(19-b)*6e4).toISOString(),value:t+(Math.random()-.5)*c}))};return e.jsxs("div",{className:"min-h-screen bg-base-200 p-6",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Monitoring Dashboard"}),e.jsxs("p",{className:"text-lg text-neutral-content/70",children:["Real-time system monitoring and performance metrics",v?e.jsx("span",{className:"text-success ml-2",children:"● Live"}):e.jsx("span",{className:"text-error ml-2",children:"● Disconnected"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("select",{className:"select select-bordered",value:x,onChange:t=>u(Number(t.target.value)),children:[e.jsx("option",{value:1e3,children:"1s"}),e.jsx("option",{value:5e3,children:"5s"}),e.jsx("option",{value:1e4,children:"10s"}),e.jsx("option",{value:3e4,children:"30s"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:n,disabled:m,children:[m?e.jsx("span",{className:"loading loading-spinner loading-sm"}):"🔄"," Refresh"]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:g.map((t,c)=>e.jsx(B,{title:t.title,subtitle:t.subtitle,status:t.status,metrics:t.metrics,refreshInterval:t.refreshInterval,onRefresh:t.onRefresh,isLoading:t.isLoading},c))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(N,{title:"CPU Usage",data:p(i.cpu?.total||40),type:"area",color:"#ef4444",unit:"%",refreshInterval:5e3,onRefresh:n}),e.jsx(N,{title:"Memory Usage",data:p(i.memory?.usage||39),type:"line",color:"#3b82f6",unit:"%",refreshInterval:5e3,onRefresh:n})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(N,{title:"Network Traffic",data:p(1024,200),type:"bar",color:"#10b981",unit:"KB/s",refreshInterval:3e3,onRefresh:n}),e.jsx(N,{title:"Response Time",data:p(125,25),type:"line",color:"#f59e0b",unit:"ms",refreshInterval:5e3,onRefresh:n})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(F,{alerts:k.map((t,c)=>({id:t.id||`alert-${c}`,type:t.severity||"info",title:t.title||"System Alert",message:t.message||"",timestamp:t.timestamp||new Date().toISOString(),source:t.source||"System",metadata:t.metadata})),onAcknowledge:t=>console.log("Acknowledged alert:",t),onResolve:t=>console.log("Resolved alert:",t),onDismiss:t=>console.log("Dismissed alert:",t),maxAlerts:10}),e.jsx(V,{maxEvents:20,showFilters:!0,autoScroll:!0,onEventClick:t=>console.log("Event clicked:",t)})]})]})};export{G as default};
