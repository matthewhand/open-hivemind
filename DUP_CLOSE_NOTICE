This PR is closed as a duplicate of PR #351.
Work has been reverted.
